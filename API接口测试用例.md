# 场外基金投资辅助工具 - API接口测试用例

## 测试概述

### 测试目的
验证场外基金投资辅助工具API接口的功能正确性、数据一致性和异常处理能力。

### 测试环境
- 基础数据：已添加5只基础基金数据
- 测试用户：普通注册用户（非管理员）
- 数据库状态：清空后重新注入基础数据

### 测试角色
- 普通用户：已注册并登录的用户，无管理员权限

## 测试用例

### 1. 用户认证模块

#### 1.1 用户注册接口
- **接口路径**: `POST /api/auth/register`
- **测试目的**: 验证新用户注册功能
- **正常情况**:
  - 输入: 有效的用户名、邮箱、密码
  - 预期结果: 返回201状态码，成功创建用户，数据库中存在该用户记录
  - **数据验证**: 
    - 检查响应中是否包含用户ID
    - 验证数据库中是否创建了对应的用户记录
    - 验证返回的访问令牌是否有效
- **异常情况**:
  - 输入: 已存在的邮箱
  - 预期结果: 返回400状态码，提示邮箱已被注册
  - **数据验证**: 
    - 验证错误信息是否为"邮箱已被注册"
    - 确认数据库中没有创建重复用户
  - 输入: 已存在的用户名
  - 预期结果: 返回400状态码，提示用户名已被使用
  - **数据验证**: 
    - 验证错误信息是否为"用户名已被使用"
    - 确认数据库中没有创建重复用户
  - 输入: 缺少必要参数
  - 预期结果: 返回400状态码，提示参数错误
  - **数据验证**: 
    - 验证错误信息是否包含缺少的参数名称
    - 确认数据库中没有创建用户记录

#### 1.2 用户登录接口
- **接口路径**: `POST /api/auth/login`
- **测试目的**: 验证用户登录功能
- **正常情况**:
  - 输入: 已注册的邮箱和正确密码
  - 预期结果: 返回200状态码，返回访问令牌和用户信息
  - **数据验证**: 
    - 验证返回的access_token格式是否正确
    - 验证返回的用户信息是否包含预期字段（id, username, email）
    - 使用返回的令牌测试其他需要认证的接口
- **异常情况**:
  - 输入: 不存在的邮箱
  - 预期结果: 返回401状态码，提示邮箱或密码错误
  - **数据验证**: 
    - 验证错误信息是否为"邮箱或密码错误"
    - 确认没有返回访问令牌
  - 输入: 错误的密码
  - 预期结果: 返回401状态码，提示邮箱或密码错误
  - **数据验证**: 
    - 验证错误信息是否为"邮箱或密码错误"
    - 确认没有返回访问令牌

#### 1.3 获取用户资料接口
- **接口路径**: `GET /api/auth/profile`
- **测试目的**: 验证获取用户资料功能
- **正常情况**:
  - 输入: 有效的访问令牌
  - 预期结果: 返回200状态码，返回用户资料信息
  - **数据验证**: 
    - 验证返回的用户信息是否与数据库中的记录一致
    - 检查返回的字段是否包含id, username, email, created_at等
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回用户信息
  - 输入: 过期的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回用户信息

#### 1.4 更新用户资料接口
- **接口路径**: `PUT /api/auth/profile`
- **测试目的**: 验证更新用户资料功能
- **正常情况**:
  - 输入: 有效的访问令牌和更新数据
  - 预期结果: 返回200状态码，成功更新用户资料
  - **数据验证**: 
    - 验证响应中返回的更新后用户信息是否正确
    - 验证数据库中的用户记录是否已更新
    - 重新获取用户资料确认更新成功
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中的用户记录没有被修改
  - 输入: 已被使用的用户名
  - 预期结果: 返回400状态码，提示用户名已被使用
  - **数据验证**: 
    - 验证错误信息是否为"用户名已被使用"
    - 确认数据库中的用户记录没有被修改

### 2. 基金数据模块

#### 2.1 获取基金列表接口
- **接口路径**: `GET /api/funds/`
- **测试目的**: 验证获取基金列表功能
- **正常情况**:
  - 输入: 无认证要求，可分页、筛选
  - 预期结果: 返回200状态码，返回基金列表和分页信息
  - **数据验证**: 
    - 验证返回的基金列表是否非空
    - 验证分页信息是否正确（page, per_page, total, pages）
    - 验证每只基金是否包含fund_code, name, net_value等必要字段
- **异常情况**:
  - 输入: 无效的分页参数
  - 预期结果: 返回正常响应，使用默认分页值
  - **数据验证**: 
    - 验证响应是否使用默认分页值（如page=1, per_page=10）

#### 2.2 获取基金详情接口
- **接口路径**: `GET /api/funds/<fund_code>`
- **测试目的**: 验证获取单个基金详情功能
- **正常情况**:
  - 输入: 有效的基金代码
  - 预期结果: 返回200状态码，返回基金详细信息和最新市场数据
  - **数据验证**: 
    - 验证返回的基金信息是否与数据库记录一致
    - 验证基金详情是否包含所有必要字段
    - 验证market_data是否包含净值、涨跌幅等信息
- **异常情况**:
  - 输入: 不存在的基金代码
  - 预期结果: 返回404状态码，提示基金不存在
  - **数据验证**: 
    - 验证错误信息是否为"基金不存在"

#### 2.3 基金搜索接口
- **接口路径**: `GET /api/funds/search`
- **测试目的**: 验证基金搜索功能
- **正常情况**:
  - 输入: 有效的搜索关键词
  - 预期结果: 返回200状态码，返回匹配的基金列表
  - **数据验证**: 
    - 验证返回的基金列表是否与搜索关键词匹配
    - 验证返回的基金是否包含fund_code, name等必要字段
- **异常情况**:
  - 输入: 空的搜索关键词
  - 预期结果: 返回400状态码，提示搜索关键词不能为空
  - **数据验证**: 
    - 验证错误信息是否为"搜索关键词不能为空"

#### 2.4 获取基金历史净值接口
- **接口路径**: `GET /api/funds/<fund_code>/history`
- **测试目的**: 验证获取基金历史净值功能
- **正常情况**:
  - 输入: 有效的基金代码
  - 预期结果: 返回200状态码，返回基金历史净值数据
  - **数据验证**: 
    - 验证返回的历史数据是否包含date, net_value, accumulated_net_value等字段
    - 验证数据是否按日期降序排列
    - 验证历史数据条数是否符合预期
- **异常情况**:
  - 输入: 不存在的基金代码
  - 预期结果: 返回404状态码，提示基金不存在
  - **数据验证**: 
    - 验证错误信息是否为"基金不存在"

### 3. 自选功能模块

#### 3.1 创建自选分组接口
- **接口路径**: `POST /api/favorites/groups`
- **测试目的**: 验证创建自选分组功能（数据流起始点）
- **正常情况**:
  - 输入: 有效的访问令牌和分组信息
  - 预期结果: 返回201状态码，成功创建分组
  - **数据验证**: 
    - 验证响应是否包含新创建的分组信息
    - 验证数据库中是否创建了新的分组记录
    - 通过获取分组列表接口验证分组确实被创建
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中没有创建分组记录
  - 输入: 已存在的分组名称
  - 预期结果: 返回400状态码，提示分组名称已存在
  - **数据验证**: 
    - 验证错误信息是否为"分组名称已存在"
    - 确认数据库中没有创建重复分组记录

#### 3.2 获取自选分组列表接口
- **接口路径**: `GET /api/favorites/groups`
- **测试目的**: 验证获取自选分组功能（在创建分组后）
- **正常情况**:
  - 输入: 有效的访问令牌
  - 预期结果: 返回200状态码，返回用户自选分组列表
  - **数据验证**: 
    - 首先通过创建自选分组接口创建一个分组
    - 验证返回的分组列表是否包含新创建的分组
    - 验证每个分组是否包含id, name, created_at等字段
    - 验证分组数量是否符合预期
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回分组列表

#### 3.3 添加自选基金接口
- **接口路径**: `POST /api/favorites/`
- **测试目的**: 验证添加自选基金功能（在创建分组后）
- **正常情况**:
  - 输入: 有效的访问令牌、已存在的基金代码和分组ID
  - 预期结果: 返回201状态码，成功添加到自选
  - **数据验证**: 
    - 首先通过创建自选分组接口创建一个分组
    - 通过基金列表接口获取一只有效的基金代码
    - 验证响应是否包含"基金已添加到自选"信息
    - 验证数据库中是否创建了自选关系记录
    - 通过获取自选列表接口验证基金确实被添加
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中没有创建自选关系记录
  - 输入: 不存在的基金代码
  - 预期结果: 返回404状态码，提示基金不存在
  - **数据验证**: 
    - 验证错误信息是否为"基金不存在"
    - 确认数据库中没有创建自选关系记录
  - 输入: 不存在的分组ID
  - 预期结果: 返回404状态码，提示分组不存在
  - **数据验证**: 
    - 验证错误信息是否为"分组不存在"
    - 确认数据库中没有创建自选关系记录
  - 输入: 已在自选中的基金
  - 预期结果: 返回400状态码，提示基金已在当前分组中
  - **数据验证**: 
    - 验证错误信息是否为"基金已在当前分组中"
    - 确认数据库中没有重复创建自选关系记录

#### 3.4 获取自选基金列表接口
- **接口路径**: `GET /api/favorites/`
- **测试目的**: 验证获取用户自选基金列表功能（在添加自选后）
- **正常情况**:
  - 输入: 有效的访问令牌
  - 预期结果: 返回200状态码，返回用户自选基金列表
  - **数据验证**: 
    - 首先通过创建自选分组接口创建一个分组
    - 通过添加自选基金接口添加至少1只基金到自选
    - 验证返回的自选列表是否包含之前添加的基金
    - 验证每只自选基金是否包含fund_code, name, current_net_value等字段
    - 验证分组信息是否正确返回
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回自选基金列表

#### 3.5 删除自选基金接口
- **接口路径**: `DELETE /api/favorites/<fund_code>`
- **测试目的**: 验证删除自选基金功能（在添加自选后）
- **正常情况**:
  - 输入: 有效的访问令牌和已在自选中的基金代码
  - 预期结果: 返回200状态码，成功移除自选基金
  - **数据验证**: 
    - 首先通过创建自选分组接口创建一个分组
    - 通过添加自选基金接口添加一只基金
    - 验证响应是否包含"自选基金已移除"信息
    - 验证数据库中对应的自选关系记录的is_deleted字段是否被设置为true
    - 通过获取自选列表接口验证基金确实被移除
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中对应的自选关系记录没有被修改
  - 输入: 不在自选中的基金代码
  - 预期结果: 返回404状态码，提示自选基金不存在
  - **数据验证**: 
    - 验证错误信息是否为"自选基金不存在"
    - 确认数据库中没有修改任何记录

#### 3.6 更新自选分组接口
- **接口路径**: `PUT /api/favorites/groups/<group_id>`
- **测试目的**: 验证更新自选分组功能（在创建分组后）
- **正常情况**:
  - 输入: 有效的访问令牌和更新的分组名称
  - 预期结果: 返回200状态码，成功更新分组
  - **数据验证**: 
    - 首先通过创建自选分组接口创建一个分组
    - 验证响应是否包含更新后的分组信息
    - 验证数据库中对应的分组记录是否已更新
    - 通过获取分组列表接口验证分组名称确实被更新
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中分组记录没有被修改
  - 输入: 已存在的分组名称
  - 预期结果: 返回400状态码，提示分组名称已存在
  - **数据验证**: 
    - 验证错误信息是否为"分组名称已存在"
    - 确认数据库中分组记录没有被修改

#### 3.7 删除自选分组接口
- **接口路径**: `DELETE /api/favorites/groups/<group_id>`
- **测试目的**: 验证删除自选分组功能（在创建分组后）
- **正常情况**:
  - 输入: 有效的访问令牌和分组ID
  - 预期结果: 返回200状态码，成功删除分组
  - **数据验证**: 
    - 首先通过创建自选分组接口创建一个分组
    - 验证响应是否包含"分组已删除"信息
    - 验证数据库中对应的分组记录是否被删除
    - 通过获取分组列表接口验证分组确实被移除
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中分组记录没有被删除
  - 输入: 不存在的分组ID
  - 预期结果: 返回404状态码，提示分组不存在
  - **数据验证**: 
    - 验证错误信息是否为"分组不存在"
    - 确认数据库中分组记录没有被删除

### 4. 交易功能模块

#### 4.1 买入基金接口
- **接口路径**: `POST /api/transactions/buy`
- **测试目的**: 验证买入基金功能（数据流起始点）
- **正常情况**:
  - 输入: 有效的访问令牌、有效的基金代码和正数金额
  - 预期结果: 返回200状态码，成功创建买入交易记录
  - **数据验证**: 
    - 首先通过基金列表接口获取有效的基金代码
    - 验证响应是否包含交易成功的确认信息
    - 验证数据库中是否创建了交易记录
    - 验证用户持仓是否相应增加
    - 通过获取持仓列表接口验证持仓数量是否正确更新
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中没有创建交易记录
  - 输入: 不存在的基金代码
  - 预期结果: 返回404状态码，提示基金不存在
  - **数据验证**: 
    - 验证错误信息是否为"基金不存在"
    - 确认数据库中没有创建交易记录
  - 输入: 无法获取基金净值
  - 预期结果: 返回400状态码，提示无法获取基金净值
  - **数据验证**: 
    - 验证错误信息是否为"无法获取基金净值"
    - 确认数据库中没有创建交易记录

#### 4.2 获取持仓列表接口
- **接口路径**: `GET /api/transactions/holdings`
- **测试目的**: 验证获取用户持仓列表功能（在买入基金后）
- **正常情况**:
  - 输入: 有效的访问令牌
  - 预期结果: 返回200状态码，返回用户持仓列表
  - **数据验证**: 
    - 首先通过买入基金接口创建持仓记录
    - 验证返回的持仓列表是否包含买入的基金
    - 验证每只持仓基金是否包含fund_code, name, shares, cost_basis, current_value, profit_loss等字段
    - 验证持仓汇总信息（总资产、盈亏总额等）是否正确计算
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回持仓列表

#### 4.3 获取单只基金持仓详情接口
- **接口路径**: `GET /api/transactions/holdings/<fund_code>`
- **测试目的**: 验证获取单只基金持仓详情功能（在买入基金后）
- **正常情况**:
  - 输入: 有效的访问令牌和有持仓的基金代码
  - 预期结果: 返回200状态码，返回持仓详情
  - **数据验证**: 
    - 首先通过买入基金接口为特定基金创建持仓
    - 验证返回的持仓详情是否包含shares, cost_basis, current_value, profit_loss等详细信息
    - 验证计算的盈亏金额和收益率是否正确
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回持仓详情
  - 输入: 不存在持仓的基金代码
  - 预期结果: 返回404状态码，提示持仓不存在
  - **数据验证**: 
    - 验证错误信息是否为"持仓不存在"

#### 4.4 卖出基金接口
- **接口路径**: `POST /api/transactions/sell`
- **测试目的**: 验证卖出基金功能（在买入基金后）
- **正常情况**:
  - 输入: 有效的访问令牌、有效的基金代码和有效的份额
  - 预期结果: 返回200状态码，成功创建卖出交易记录
  - **数据验证**: 
    - 首先通过买入基金接口创建持仓
    - 验证响应是否包含交易成功的确认信息
    - 验证数据库中是否创建了卖出交易记录
    - 验证用户持仓是否相应减少
    - 通过获取持仓列表接口验证持仓数量是否正确更新
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中没有创建交易记录
  - 输入: 不存在的基金代码
  - 预期结果: 返回404状态码，提示基金不存在
  - **数据验证**: 
    - 验证错误信息是否为"基金不存在"
    - 确认数据库中没有创建交易记录
  - 输入: 份额不足
  - 预期结果: 返回400状态码，提示份额不足
  - **数据验证**: 
    - 验证错误信息是否为"份额不足"
    - 确认数据库中没有创建交易记录

#### 4.5 获取交易记录接口
- **接口路径**: `GET /api/transactions/transactions`
- **测试目的**: 验证获取交易记录功能（在买入/卖出基金后）
- **正常情况**:
  - 输入: 有效的访问令牌
  - 预期结果: 返回200状态码，返回用户交易记录列表
  - **数据验证**: 
    - 首先通过买入/卖出基金接口创建交易记录
    - 验证返回的交易记录列表是否包含之前创建的交易
    - 验证每条交易记录是否包含type, fund_code, amount, shares, price, timestamp等字段
    - 验证交易记录是否按时间倒序排列
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回交易记录列表

#### 4.6 获取资产概览接口
- **接口路径**: `GET /api/transactions/portfolio/overview`
- **测试目的**: 验证获取资产概览功能（在买入基金后）
- **正常情况**:
  - 输入: 有效的访问令牌
  - 预期结果: 返回200状态码，返回资产概览数据
  - **数据验证**: 
    - 首先通过买入基金接口创建持仓
    - 验证返回的概览数据是否包含total_value, total_profit_loss, profit_loss_rate等关键指标
    - 验证各项数值计算是否正确
    - 验证数据是否与持仓列表接口返回的信息一致
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回资产概览数据

### 5. 消息中心模块

#### 5.1 标记消息为已读接口
- **接口路径**: `PUT /api/notifications/<notification_id>/read`
- **测试目的**: 验证标记消息为已读功能
- **正常情况**:
  - 输入: 有效的访问令牌和存在的消息ID
  - 预期结果: 返回200状态码，成功标记为已读
  - **数据验证**: 
    - 首先通过获取消息列表接口获取一条未读消息的ID
    - 验证响应是否包含操作成功的确认信息
    - 验证数据库中对应消息的is_read字段是否被更新为true
    - 通过获取消息列表接口验证消息状态是否已更新
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中消息的is_read字段没有被修改
  - 输入: 不存在的消息ID
  - 预期结果: 返回404状态码，提示消息不存在
  - **数据验证**: 
    - 验证错误信息是否为"消息不存在"
    - 确认数据库中没有修改任何消息记录

#### 5.2 标记所有消息为已读接口
- **接口路径**: `PUT /api/notifications/read-all`
- **测试目的**: 验证标记所有消息为已读功能
- **正常情况**:
  - 输入: 有效的访问令牌
  - 预期结果: 返回200状态码，成功标记所有消息为已读
  - **数据验证**: 
    - 首先通过系统接口为用户创建多条消息
    - 验证响应是否包含操作成功的确认信息
    - 验证数据库中该用户的所有未读消息的is_read字段是否都被更新为true
    - 通过获取消息列表接口验证所有消息状态是否都已更新
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中消息记录没有被修改

#### 5.3 删除消息接口
- **接口路径**: `DELETE /api/notifications/<notification_id>`
- **测试目的**: 验证删除消息功能
- **正常情况**:
  - 输入: 有效的访问令牌和存在的消息ID
  - 预期结果: 返回200状态码，成功删除消息
  - **数据验证**: 
    - 首先通过获取消息列表接口获取一条消息的ID
    - 验证响应是否包含操作成功的确认信息
    - 验证数据库中对应消息的is_deleted字段是否被设置为true（逻辑删除）
    - 通过获取消息列表接口验证消息是否从列表中移除
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中消息记录没有被修改
  - 输入: 不存在的消息ID
  - 预期结果: 返回404状态码，提示消息不存在
  - **数据验证**: 
    - 验证错误信息是否为"消息不存在"
    - 确认数据库中没有修改任何消息记录

#### 5.4 获取消息列表接口
- **接口路径**: `GET /api/notifications/`
- **测试目的**: 验证获取消息列表功能
- **正常情况**:
  - 输入: 有效的访问令牌
  - 预期结果: 返回200状态码，返回用户消息列表
  - **数据验证**: 
    - 首先通过系统或管理员接口为用户创建消息
    - 验证返回的消息列表是否包含创建的消息
    - 验证每条消息是否包含id, title, content, is_read, created_at等字段
    - 验证消息是否按时间倒序排列
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回消息列表

### 6. 设置模块

#### 6.1 获取用户设置接口
- **接口路径**: `GET /api/settings/`
- **测试目的**: 验证获取用户设置功能
- **正常情况**:
  - 输入: 有效的访问令牌
  - 预期结果: 返回200状态码，返回用户设置信息
  - **数据验证**: 
    - 验证返回的设置信息是否包含theme, notification_enabled, auto_refresh等字段
    - 验证各项设置的默认值是否正确
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回用户设置信息

#### 6.2 更新用户设置接口
- **接口路径**: `PUT /api/settings/`
- **测试目的**: 验证更新用户设置功能
- **正常情况**:
  - 输入: 有效的访问令牌和设置数据
  - 预期结果: 返回200状态码，成功更新设置
  - **数据验证**: 
    - 首先通过获取用户设置接口获取当前设置
    - 验证响应是否包含更新后的设置信息
    - 验证数据库中对应的设置记录是否已更新
    - 通过获取用户设置接口验证设置确实被更新
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认数据库中设置记录没有被修改

#### 6.3 清理缓存接口
- **接口路径**: `POST /api/settings/clear-cache`
- **测试目的**: 验证清理缓存功能
- **正常情况**:
  - 输入: 有效的访问令牌
  - 预期结果: 返回200状态码，成功清理缓存
  - **数据验证**: 
    - 验证响应是否包含"缓存清理成功"确认信息
    - 验证系统性能指标是否有所改善（如响应时间）
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认缓存清理操作没有执行

### 7. 首页模块

#### 7.1 获取首页概览接口
- **接口路径**: `GET /api/home/overview`
- **测试目的**: 验证获取首页概览功能（在创建持仓、自选等数据后）
- **正常情况**:
  - 输入: 有效的访问令牌
  - 预期结果: 返回200状态码，返回首页概览数据
  - **数据验证**: 
    - 首先通过买入基金接口创建持仓
    - 通过创建自选分组并添加自选基金
    - 验证返回的概览数据是否包含portfolio_overview, favorite_funds, market_trends等信息
    - 验证各项数据是否与持仓、自选、市场行情模块返回的数据一致
    - 验证数据汇总计算是否正确
- **异常情况**:
  - 输入: 无效的访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回首页概览数据
  - 输入: 无访问令牌
  - 预期结果: 返回401状态码，提示未授权
  - **数据验证**: 
    - 验证错误信息是否为"未授权"
    - 确认没有返回首页概览数据

## 测试执行计划

### 准备阶段
1. 清空数据库并重新注入基础数据
2. 启动Flask应用
3. 创建测试用户并获取访问令牌

### 执行阶段
1. 按模块顺序执行测试用例
2. 每个测试用例执行前构造必要的测试数据
3. 记录每个测试用例的执行结果
4. 验证预期结果与实际结果是否一致
5. 验证数据库状态是否符合预期

### 验证阶段
1. 检查数据一致性
2. 验证异常处理正确性
3. 确认接口安全性
4. 生成测试报告

## 预期结果

所有正常情况的测试用例应成功执行并返回预期结果，所有异常情况的测试用例应正确处理异常并返回适当的错误码。数据验证步骤应确认API响应与数据库状态的一致性。